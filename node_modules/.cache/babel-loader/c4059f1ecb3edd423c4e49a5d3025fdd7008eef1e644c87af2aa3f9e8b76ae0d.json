{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport axios from 'axios';\nexport default {\n  data() {\n    return {\n      total: null,\n      records: [],\n      currentPage: 1,\n      // 当前页码  \n      pageSize: 10,\n      // 每页显示的条目数  \n      dialogFormVisible: false,\n      form: {\n        id: null,\n        name: '',\n        price: '',\n        description: '',\n        status: null,\n        image: ''\n      },\n      fileList: []\n    };\n  },\n  methods: {\n    submitForm() {\n      this.dialogFormVisible = false;\n      console.log(this.form.id);\n      axios.post('/api/business/dish/edit', {\n        id: this.form.id,\n        description: this.form.description,\n        name: this.form.name,\n        price: this.form.price,\n        status: this.form.status\n      }, {\n        headers: {\n          \"token\": localStorage.getItem(\"token\")\n        }\n      }).then(res => {\n        console.log(res.data);\n      });\n    },\n    openDialog(row) {\n      this.dialogFormVisible = true;\n      this.form = row;\n    },\n    update(e) {\n      let file = e.target.files[0];\n      let param = new FormData(); //创建form对象\n      param.append('file', file); //通过append向form对象添加数据\n      param.append(\"id\", this.form.id);\n      console.log(param.get('file')); //FormData私有类对象，访问不到，可以通过get判断值是否传进去\n      let config = {\n        headers: {\n          'Content-Type': 'multipart/form-data',\n          \"token\": localStorage.getItem(\"token\")\n        } //这里是重点，需要和后台沟通好请求头，Content-Type不一定是这个值\n      }; //添加请求头\n      axios.post('/api/business/dish/upload', param, config).then(response => {\n        console.log(response.data);\n      });\n      location.reload();\n    },\n    changePage() {\n      axios({\n        //菜品分页查询\n        url: '/api/business/dish/page',\n        method: 'get',\n        headers: {\n          \"token\": localStorage.getItem('token')\n        },\n        params: {\n          name: null,\n          //就是输入框得到的要查询菜品的名字，默认没有\n          page: this.currentPage,\n          status: null\n        }\n      }).then(res => {\n        if (res.data.message == \"NOT_LOGIN\") {\n          this.$router.push('/business/login');\n          return;\n        }\n        console.log(res.data.data);\n        this.total = res.data.data.total;\n        this.records = res.data.data.records;\n      }).catch(err => {\n        console.log(err.data.msg);\n      });\n    }\n  },\n  mounted() {\n    this.changePage();\n  }\n};","map":{"version":3,"names":["axios","data","total","records","currentPage","pageSize","dialogFormVisible","form","id","name","price","description","status","image","fileList","methods","submitForm","console","log","post","headers","localStorage","getItem","then","res","openDialog","row","update","e","file","target","files","param","FormData","append","get","config","response","location","reload","changePage","url","method","params","page","message","$router","push","catch","err","msg","mounted"],"sources":["src/components/business/BusinessDishManage.vue"],"sourcesContent":["TODO 点击菜品管理，自动跳转到分页查询，这个界面要借鉴黑马苍穹外卖的UI设计，有分页查询（包括关键字查询），新增、编辑，删除菜品，删除接口的后端config代理我没配置，这个得在按钮的@click的方法里配置\r\nTODO\r\n新增菜品跳转到src\\views\\business\\dishfunction\\AddDishView.vue界面，编辑菜品跳转到src\\views\\business\\dishfunction\\EditDishView.vue，这个你们自己添加跳转按钮和配置路由\r\nTODO 要注意编辑菜品和删除菜品的按钮是一个菜品一个，新增菜品只有一个\r\nTODO 请求时候data里面的数据得根据前端设计设置，这个你们来加\r\n<template>\r\n  <div>\r\n    <el-table :data=\"records\" style=\"width: 100%\">\r\n      <el-table-column label=\"图片\" width=\"150\">\r\n        <template slot-scope=\"scope\">\r\n          <img :src=\"scope.row.image\" alt=\"菜品图片\" style=\"width: 100%; height: auto;\">\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column prop=\"id\" label=\"id\" width=\"180\" v-if=\"false\"></el-table-column>\r\n      <el-table-column prop=\"name\" label=\"菜品名称\" width=\"180\"></el-table-column>\r\n      <el-table-column prop=\"price\" label=\"价格\" width=\"120\"></el-table-column>\r\n      <el-table-column label=\"描述\" prop=\"description\"></el-table-column>\r\n\r\n      <el-table-column label=\"状态\" prop=\"status\">\r\n        <template slot-scope=\"scope\">\r\n          <span v-if=\"scope.row.status === '0'\">停止售卖</span>\r\n          <span v-else-if=\"scope.row.status === '1'\">正在售卖</span>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"销售次数\" prop=\"sum\" width=\"120\"></el-table-column>\r\n      <el-table-column label=\"功能\" width=\"150\">\r\n        <template slot-scope=\"scope\">\r\n\r\n          <el-button type=\"text\" @click=\"openDialog(scope.row)\">编辑</el-button>\r\n\r\n\r\n\r\n          <el-dialog title=\"修改菜品信息\" :visible.sync=\"dialogFormVisible\">\r\n            <el-form :model=\"form\">\r\n              <el-form-item label=\"菜品名称\" :label-width=\"'120px'\">\r\n                <el-input v-model=\"form.name\" autocomplete=\"off\"></el-input>\r\n              </el-form-item>\r\n              <el-form-item label=\"菜品价格\" :label-width=\"'120px'\">\r\n                <el-input v-model=\"form.price\" autocomplete=\"off\"></el-input>\r\n              </el-form-item>\r\n              <el-form-item label=\"菜品描述\" :label-width=\"'120px'\">\r\n                <el-input v-model=\"form.description\" autocomplete=\"off\"></el-input>\r\n              </el-form-item>\r\n              <el-form-item label=\"菜品状态\" :label-width=\"'120px'\">\r\n                <el-select v-model=\"form.region\" placeholder=\"请选择菜品状态\">\r\n                  <el-option label=\"正在售卖\" value=1></el-option>\r\n                  <el-option label=\"停止售卖\" value=0></el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n\r\n              <el-form-item label=\"菜品图片\" :label-width=\"'120px'\">\r\n                <input name=\"file\" type=\"file\" accept=\"image/png,image/gif,image/jpeg\" @change=\"update\" />\r\n              </el-form-item>\r\n\r\n\r\n            </el-form>\r\n\r\n            <div slot=\"footer\" class=\"dialog-footer\">\r\n              <el-button @click=\"dialogFormVisible = false\">取 消</el-button>\r\n              <el-button type=\"primary\" @click=\"submitForm\">确 定</el-button>\r\n            </div>\r\n          </el-dialog>\r\n\r\n          <el-button type=\"text\" @click=\"openDialog(scope.row)\">删除</el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n\r\n    <div style=\"margin-top: 20px;\">\r\n      <el-pagination :current-page=\"currentPage\" :page-size=\"pageSize\" @current-change=\"changePage\" layout=\"total\"\r\n        :total=\"total\"></el-pagination>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\n  import axios from 'axios';\r\n\r\n  export default {\r\n    data () {\r\n      return {\r\n        total: null,\r\n        records: [],\r\n        currentPage: 1, // 当前页码  \r\n        pageSize: 10, // 每页显示的条目数  \r\n        dialogFormVisible: false,\r\n        form: {\r\n          id: null,\r\n          name: '',\r\n          price: '',\r\n          description: '',\r\n          status: null,\r\n          image: ''\r\n        },\r\n        fileList: []\r\n      };\r\n    },\r\n    methods: {\r\n      submitForm () {\r\n        this.dialogFormVisible = false\r\n        console.log(this.form.id)\r\n        axios.post('/api/business/dish/edit', {\r\n          id: this.form.id,\r\n          description: this.form.description,\r\n          name: this.form.name,\r\n          price: this.form.price,\r\n          status: this.form.status\r\n        },\r\n          {\r\n            headers: {\r\n              \"token\": localStorage.getItem(\"token\")\r\n            }\r\n          }).then(res => {\r\n            console.log(res.data);\r\n          })\r\n\r\n      },\r\n      openDialog (row) {\r\n        this.dialogFormVisible = true\r\n        this.form = row\r\n      },\r\n      update (e) {\r\n        let file = e.target.files[0];\r\n        let param = new FormData(); //创建form对象\r\n        param.append('file', file);//通过append向form对象添加数据\r\n        param.append(\"id\", this.form.id)\r\n        console.log(param.get('file')); //FormData私有类对象，访问不到，可以通过get判断值是否传进去\r\n        let config = {\r\n          headers: {\r\n            'Content-Type': 'multipart/form-data',\r\n            \"token\": localStorage.getItem(\"token\")\r\n          } //这里是重点，需要和后台沟通好请求头，Content-Type不一定是这个值\r\n        }; //添加请求头\r\n        axios.post('/api/business/dish/upload', param, config)\r\n          .then(response => {\r\n            console.log(response.data);\r\n          })\r\n        location.reload();\r\n      },\r\n      changePage () {\r\n        axios({//菜品分页查询\r\n          url: '/api/business/dish/page',\r\n          method: 'get',\r\n          headers: {\r\n            \"token\": localStorage.getItem('token')\r\n          },\r\n          params: {\r\n            name: null,//就是输入框得到的要查询菜品的名字，默认没有\r\n            page: this.currentPage,\r\n            status: null\r\n          }\r\n        }).then(res => {\r\n          if (res.data.message == \"NOT_LOGIN\") {\r\n            this.$router.push('/business/login')\r\n            return;\r\n          }\r\n          console.log(res.data.data)\r\n          this.total = res.data.data.total\r\n          this.records = res.data.data.records\r\n        }).catch(err => {\r\n          console.log(err.data.msg)\r\n        })\r\n      }\r\n    },\r\n    mounted () {\r\n      this.changePage()\r\n    },\r\n\r\n  }\r\n</script>\r\n\r\n<style>\r\n\r\n</style>"],"mappings":";AA2EA,OAAAA,KAAA;AAEA;EACAC,KAAA;IACA;MACAC,KAAA;MACAC,OAAA;MACAC,WAAA;MAAA;MACAC,QAAA;MAAA;MACAC,iBAAA;MACAC,IAAA;QACAC,EAAA;QACAC,IAAA;QACAC,KAAA;QACAC,WAAA;QACAC,MAAA;QACAC,KAAA;MACA;MACAC,QAAA;IACA;EACA;EACAC,OAAA;IACAC,WAAA;MACA,KAAAV,iBAAA;MACAW,OAAA,CAAAC,GAAA,MAAAX,IAAA,CAAAC,EAAA;MACAR,KAAA,CAAAmB,IAAA;QACAX,EAAA,OAAAD,IAAA,CAAAC,EAAA;QACAG,WAAA,OAAAJ,IAAA,CAAAI,WAAA;QACAF,IAAA,OAAAF,IAAA,CAAAE,IAAA;QACAC,KAAA,OAAAH,IAAA,CAAAG,KAAA;QACAE,MAAA,OAAAL,IAAA,CAAAK;MACA,GACA;QACAQ,OAAA;UACA,SAAAC,YAAA,CAAAC,OAAA;QACA;MACA,GAAAC,IAAA,CAAAC,GAAA;QACAP,OAAA,CAAAC,GAAA,CAAAM,GAAA,CAAAvB,IAAA;MACA;IAEA;IACAwB,WAAAC,GAAA;MACA,KAAApB,iBAAA;MACA,KAAAC,IAAA,GAAAmB,GAAA;IACA;IACAC,OAAAC,CAAA;MACA,IAAAC,IAAA,GAAAD,CAAA,CAAAE,MAAA,CAAAC,KAAA;MACA,IAAAC,KAAA,OAAAC,QAAA;MACAD,KAAA,CAAAE,MAAA,SAAAL,IAAA;MACAG,KAAA,CAAAE,MAAA,YAAA3B,IAAA,CAAAC,EAAA;MACAS,OAAA,CAAAC,GAAA,CAAAc,KAAA,CAAAG,GAAA;MACA,IAAAC,MAAA;QACAhB,OAAA;UACA;UACA,SAAAC,YAAA,CAAAC,OAAA;QACA;MACA;MACAtB,KAAA,CAAAmB,IAAA,8BAAAa,KAAA,EAAAI,MAAA,EACAb,IAAA,CAAAc,QAAA;QACApB,OAAA,CAAAC,GAAA,CAAAmB,QAAA,CAAApC,IAAA;MACA;MACAqC,QAAA,CAAAC,MAAA;IACA;IACAC,WAAA;MACAxC,KAAA;QAAA;QACAyC,GAAA;QACAC,MAAA;QACAtB,OAAA;UACA,SAAAC,YAAA,CAAAC,OAAA;QACA;QACAqB,MAAA;UACAlC,IAAA;UAAA;UACAmC,IAAA,OAAAxC,WAAA;UACAQ,MAAA;QACA;MACA,GAAAW,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAAvB,IAAA,CAAA4C,OAAA;UACA,KAAAC,OAAA,CAAAC,IAAA;UACA;QACA;QACA9B,OAAA,CAAAC,GAAA,CAAAM,GAAA,CAAAvB,IAAA,CAAAA,IAAA;QACA,KAAAC,KAAA,GAAAsB,GAAA,CAAAvB,IAAA,CAAAA,IAAA,CAAAC,KAAA;QACA,KAAAC,OAAA,GAAAqB,GAAA,CAAAvB,IAAA,CAAAA,IAAA,CAAAE,OAAA;MACA,GAAA6C,KAAA,CAAAC,GAAA;QACAhC,OAAA,CAAAC,GAAA,CAAA+B,GAAA,CAAAhD,IAAA,CAAAiD,GAAA;MACA;IACA;EACA;EACAC,QAAA;IACA,KAAAX,UAAA;EACA;AAEA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}